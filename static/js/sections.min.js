class Control{constructor(){this.templates=new controlTemplates();this.getCards();this.version=5;}
action(MAC,payload){session.refresh();tools.req('/control/action',function(status,response){if(status===200){tools.snack("Done")}else{tools.snack("Failed!")}}.bind(this),{'mac':MAC,'payload':payload});}
update(){tools.req('/control/update',function(status,response){if(status===200){this.updateCards(response);}else if(status===401){clearInterval(tools.interval);}else{tools.snack("No internet");}}.bind(this));}
getCards(){tools.showLoading("data");tools.req('/control/list',function(status,response){if(status===200){var cards="";for(var i=0;i<response['own'].length;i++){var MAC=response['own'][i]['mac'];var name=response['own'][i]['name'];var update=this.templates.update;if(parseInt(response['own'][i]['version'])==this.version){update="";}
cards+=this.templates.card.render({update:update,name:name,MAC:MAC});}
if(response['share'].length>0){var cards=cards+this.templates.divider.format('Shared');for(var i=0;i<response['share'].length;i++){var MAC=response['share'][i]['mac'];var name=response['share'][i]['name'];var update=this.templates.update;if(parseInt(response['share'][i]['version'])==this.version){update="";}
cards+=this.templates.card.render({update:update,name:name,MAC:MAC});}}
document.getElementById("grid").innerHTML=cards;tools.updateMDL();this.updateCards(response['own']);this.updateCards(response['share']);this.update();tools.interval=setInterval(active.update.bind(this),1000);tools.hideDiag();}else{tools.hideDiag();}}.bind(this));}
updateCards(response){var boardStatus={null:'url(/img/papelito.png)',"0":'url(/img/off.jpg)',"1":'url(/img/on.jpg)',"2":'url(/img/suspended.gif)',"7":'url(/img/updating.gif)',"8":'url(/img/recovery.jpg',"9":'url(/img/boardoff.png)'};var boardAction={null:'/done',"0":'/waiting',"1":'/waiting',"2":'/waiting',"3":'/on',"4":'/turning',"5":'/error',"6":'/done',"7":'/waiting',"8":'/waiting',"9":'/waiting'};var actions=Object.keys(boardAction);for(var i=0;i<response.length;i++){try{document.getElementById(response[i].mac).style.backgroundImage=boardStatus[response[i].status];}catch(error){document.getElementById(response[i].mac).style.backgroundImage='url(/img/papelito.png)';}
tools.hide(response[i].mac+'/error');tools.hide(response[i].mac+'/on');tools.hide(response[i].mac+'/done');tools.hide(response[i].mac+'/waiting');tools.hide(response[i].mac+'/turning');if(response[i].status!='9'&&response[i].status!=null){tools.show(response[i].mac+boardAction[response[i].action]);}}}}
class controlTemplates{constructor(){this.divider=`
<div class="mdl-cell mdl-cell--12-col">
<div class="hr-sect"><span class="mdl-layout-title">{}</span></div>
</div>
  `;this.update=`<button class="mdl-button mdl-js-button mdl-button--raised mdl-button mdl-js-ripple-effect"
                data-upgraded=",MaterialButton,MaterialRipple" style="display: inline; visibility: visible;">
            <i class="material-icons">system_update_alt</i> Update available
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>`;this.card=`<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
    <div
        class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
        <div id="{{MAC}}" class="on mdl-card--expand mdl-color--teal-300" style="background-image: url('img/off.jpg');">
        </div>
        <button id="{{MAC}}/error"
            class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect"
            data-upgraded=",MaterialButton,MaterialRipple" style="display: none; visibility: visible;">
            <i class="material-icons">warning</i>Action has not been completed
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>
        <button id="{{MAC}}/on" class="mdl-button mdl-js-button mdl-button--raised mdl-button mdl-js-ripple-effect"
            data-upgraded=",MaterialButton,MaterialRipple" style="display: none;">
            <i class="material-icons">offline_bolt</i> Keep on is enabled
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>
        <button id="{{MAC}}/done" class="mdl-button mdl-js-button mdl-button--raised mdl-button mdl-js-ripple-effect"
            data-upgraded=",MaterialButton,MaterialRipple" style="display: inline; visibility: visible;">
            <i class="material-icons">done</i> Waiting for command
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

        {{update}}

        <div class="mdl-card__supporting-text mdl-color-text--grey-600">{{name}} ({{MAC}})</div>

        <div id="{{MAC}}/waiting" style="display: none;">
            <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                <center>
                    <bold>Waiting for response...</bold>
                </center>
            </div>
            <div class="mdl-progress mdl-js-progress mdl-progress__indeterminate is-upgraded"
                data-upgraded=",MaterialProgress">
                <div class="progressbar bar bar1" style="width: 0%;"></div>
                <div class="bufferbar bar bar2" style="width: 100%;"></div>
                <div class="auxbar bar bar3" style="width: 0%;"></div>
            </div>
        </div>

        <div id="{{MAC}}/turning" style="display: none;">
            <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                <center>
                    <bold>Working on it...</bold>
                </center>
            </div>
            <div class="mdl-progress mdl-js-progress mdl-progress__indeterminate is-upgraded"
                data-upgraded=",MaterialProgress">
                <div class="progressbar bar bar1" style="width: 0%;"></div>
                <div class="bufferbar bar bar2" style="width: 100%;"></div>
                <div class="auxbar bar bar3" style="width: 0%;"></div>
            </div>
        </div>

        <div class="mdl-card__actions mdl-card--border mdl-typography--text-center">
            <button onclick="active.action('{{MAC}}','0')" class="mdl-button mdl-js-button mdl-button--primary">
                <i class="material-icons">power_settings_new</i></button>

            <button style="right: 5px; position: absolute; display: inline-flex; vertical-align: middle;" id="menu_{{MAC}}"
                class="mdl-button mdl-js-button mdl-button--icon">
                <i class="material-icons">more_vert</i>
            </button>

            <ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" data-mdl-for="menu_{{MAC}}">
                <li class="mdl-menu__item mdl-js-ripple-effect" onclick="showDialog({
                title: 'Are you sure?',
                text: 'The board needs an active Internet connection and uninterrupted power<br><br><b>Remember</b> -> Reload the page to dismiss the update message',
                positive: {
                title: 'Yes',
                onClick: function (e) {
                active.action('{{MAC}}', '8');
                }
                },
                negative: {
                title: 'No'
                }
                });" tabindex="-1" data-upgraded=",MaterialRipple"><i class="material-icons"
                        style="display: inline-flex; vertical-align: middle;">system_update</i>
                    Update firmware<span class="mdl-menu__item-ripple-container"><span class="mdl-ripple"></span></span>
                </li>
                <li class="mdl-menu__item mdl-js-ripple-effect" onclick="active.action('{{MAC}}','9')" tabindex="-1"
                    data-upgraded=",MaterialRipple"><i class="material-icons"
                        style="display: inline-flex; vertical-align: middle;">av_timer</i>
                    Recovery<span class="mdl-menu__item-ripple-container"><span class="mdl-ripple"></span></span></li>
                <li class="mdl-menu__item mdl-js-ripple-effect" onclick="showDialog({
                title: 'Are you sure?',
                text: 'Forcing the PC to shutdown will cut the power, meaning no data will be saved before.',
                positive: {
                title: 'Yes',
                onClick: function (e) {
                active.action('{{MAC}}', '1');
                }
                },
                negative: {
                title: 'No'
                }
                });" tabindex="-1" data-upgraded=",MaterialRipple"><i class="material-icons"
                        style="display: inline-flex; vertical-align: middle;">stop</i>
                    Force off<span class="mdl-menu__item-ripple-container"><span class="mdl-ripple"></span></span></li>
            </ul>
        </div>
    </div>
</div>`;}}class Manager{constructor(){this.templates=new managerTemplates();this.getCards();}
getCards(){tools.showLoading("boards manager");tools.req('/manager/list',function(status,response){tools.hideDiag();if(status===200){var cards="";var boards=Object.keys(response['own']);this.total=boards.length;for(var i=0;i<boards.length;i++){var MAC=response['own'][i]['mac'];var name=response['own'][i]['name'];var shareWith=response['own'][i]['shareWith'];cards+=this.templates.card.render({MAC:MAC,name:name,shareWith:shareWith});}
if(response['share'].length>0){this.total=this.total+response['share'].length;var cards=cards+this.templates.divider.format('Shared');for(var i=0;i<response['share'].length;i++){var MAC=response['share'][i]['mac'];var name=response['share'][i]['name'];cards=cards+this.templates.shared.render({name:name,MAC:MAC});}}
document.getElementById("grid").innerHTML=cards+this.templates.divider.format('New board')+this.templates.newCard;componentHandler.upgradeAllRegistered();}else{session.logOut();}}.bind(this));}
add(){session.refresh();var mac=document.getElementById("new_MAC").value;var name=document.getElementById("new_Name").value;var filter=/^([a-zA-Z0-9]{1,10})$/;var re=/^(([A-Fa-f0-9]{2}[:]){5}[A-Fa-f0-9]{2}[,]?)+$/;if(filter.test(name)&&re.test(mac)){tools.req('/manager/change',function(status,response){if(status===200){tools.snack("Done");this.getCards();}else{tools.snack("Failed!")}
this.getCards();}.bind(this),{'mac':mac,'type':"8",'name':name});}else{tools.snack("Wrong input");}}
save(MAC){session.refresh();var name=document.getElementById(MAC+"_name");var cluster=(document.getElementById(MAC+"_cluster").checked)?'1':'0';var filter=/^([a-zA-Z0-9]{1,10})$/;if(!filter.test(name.value)){tools.show(MAC+"_characters");}else{tools.hide(MAC+"_characters");tools.req('/manager/change',function(status,response){if(status===200){tools.snack("Done");this.getCards();}else{tools.snack("Failed!")}}.bind(this),{'mac':MAC,'type':"0",'name':name.value,'cluster':cluster
});}}
checkShare(){var email=document.getElementById("email");var filter=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(email.value.length>0){if(!filter.test(email.value)){tools.show("valid");tools.hide("save");}else{tools.hide("valid");tools.show("save");}}else{tools.show("save");tools.hide("valid");}}
share(MAC,old,email){session.refresh();if(email===undefined){showDialog({title:'Insert e-mail address of receiver (blank to disable it):',text:`<center><form action="javascript:">
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <div class="popup">
            <span class="popuptext" id="valid">Please insert a valid email address or leave it blank to disable it</span></div>
            <input class="mdl-textfield__input" type="email" id="email" onkeyup="active.checkShare()" value="{}">
            <label class="mdl-textfield__label" for="sample1">Email:</label>
            </div>
            </form></center>`.format(old),positive:{title:'<h style="color:green;">Share</h>',id:'save',onClick:function(){active.share(MAC,old,true);}},negative:{title:'<h style="color:red;" disabled>Cancel</h>'},onLoaded:function(){tools.hide("save");}});}else{var email=document.getElementById("email").value;tools.hideDiag();tools.showLoading();tools.req('/manager/change',function(status,response){if(status===200){tools.snack("Done");this.getCards();}else{tools.hideDiag();tools.snack("Failed!");}}.bind(this),{"type":"1","email":tools.encodeSTR(email),"mac":MAC});}}
removeShare(MAC,force){session.refresh();if(force){tools.req('/manager/change',function(status,response){tools.hideDiag();if(status===200){tools.snack("Done");this.getCards();}else{tools.snack("Failed!");}}.bind(this),{"type":"1","email":"","mac":MAC});}else{if(this.total!==1||confirm("Removing the last board will delete this account! Are you sure?")){showDialog({title:`<h3 class="mdl-dialog__title" style="width:100%">Are you sure?</h3>`,text:`<br><center>Shared boards can't be added by user</center><br>`,negative:{title:'<h style="color:green;" disabled>No</h>',},positive:{title:'<h style="color:red;" disabled>Yes</h>',onClick:function(){active.removeShare(MAC,true);}},cancelable:true,contentStyle:{'max-width':'300px'},});}}}
remove(MAC,force){session.refresh();if(force){tools.req('/manager/change',function(status,response){tools.hideDiag();if(status===200){tools.snack("Done");this.getCards();}else{tools.snack("Failed!");}}.bind(this),{'mac':MAC,'type':"9"});}else{if(this.total!==1||confirm("Removing the last board will delete this account! Are you sure?")){showDialog({title:'<h3 class="mdl-dialog__title" style="width:100%">Are you sure?</h3>',text:'<br>',negative:{title:'<h style="color:green;" disabled>No</h>',},positive:{title:'<h style="color:red;" disabled>Yes</h>',onClick:function(){active.remove(MAC,true);}},cancelable:true,contentStyle:{'max-width':'300px'},});}}}}
class managerTemplates{constructor(){this.divider=`
<div class="mdl-cell mdl-cell--12-col">
<div class="hr-sect"><span class="mdl-layout-title">{}</span></div>
</div>
  `;this.card=`<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
  <div
    class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
    <div class="on mdl-card--expand mdl-color--teal-300"></div>
    <div class="mdl-card__supporting-text mdl-color-text--grey-900">{{MAC}}</div>
    <div class="popup" style="width:100%"
      onclick="document.getElementById('{{MAC}}_characters').style.display = 'none';">
      <span class="popuptext" id="{{MAC}}_characters">- 8-20 characters<br>- Only letters and numbers</span></div>
    <div class="popup" style="width:100%" onclick="document.getElementById('{{MAC}}_old').style.display = 'none';">
      <span class="popuptext" id="{{MAC}}_old">Please use a new name</span></div>
    <div style="margin:0 auto;"
      class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty is-upgraded"
      data-upgraded=",MaterialTextfield">
      <input class="mdl-textfield__input" type="text" name="name" value="{{name}}" id="{{MAC}}_name">
      <label class="mdl-textfield__label" for="{{MAC}}_name" style="color:#00bcd4;">Change name:</label>
    </div>
    <div class="mdl-card__actions mdl-card--border">
      <center>
        <button href="#" class="mdl-button mdl-js-button mdl-js-ripple-effect" onclick="active.save('{{MAC}}')"
          style="color: #00bcd4;" data-upgraded=",MaterialButton,MaterialRipple">
          Save
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>
        <button class="mdl-button mdl-js-button" style="color:#3CB92A;" onclick="active.share('{{MAC}}', '{{shareWith}}');"
          data-upgraded=",MaterialButton">
          <i class="material-icons">share</i>
        </button>
        <button class="mdl-button mdl-js-button" style="color:red;" onclick="active.remove('{{MAC}}');"
          data-upgraded=",MaterialButton">
          Remove
        </button>
      </center>
    </div>
  </div>
</div>`;this.shared=`<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
    <div
        class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
        <div class="on mdl-card--expand mdl-color--teal-300"> </div>
        <div class="mdl-card__supporting-text mdl-color-text--grey-900">{{name}} ({{MAC}})</div>
        </center>
        <div class="mdl-card__actions mdl-card--border">
            <center>
                <button class="mdl-button mdl-js-button" style="color:red;" onclick="active.removeShare('{{MAC}}');"
                    data-upgraded=",MaterialButton">
                    Remove
                </button>
            </center>
        </div>
    </div>
</div>`;this.newCard=`<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
    <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">
    <div class="new mdl-card--expand mdl-color-add"> </div>
    <center>
    <div style="margin:0 auto;"
         class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty is-upgraded"
         data-upgraded=",MaterialTextfield">
      <input class="mdl-textfield__input" type="text" name="name" id="new_MAC" name="MAC">
      <label class="mdl-textfield__label" for="{}_name" style="color:#00bcd4;">MAC:</label>
    </div>
    <div style="margin:0 auto;"
         class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty is-upgraded"
         data-upgraded=",MaterialTextfield">
      <input class="mdl-textfield__input" type="text" name="name" id="new_Name">
      <label class="mdl-textfield__label" for="{}_name" style="color:#00bcd4;">Name:</label>
    </div>
    </center>
    <button class="mdl-button mdl-js-button mdl-js-ripple-effect" type="button" onclick="active.add()">Add</button>
    </div>
    </div>`}}class Settings{constructor(){this.templates=new settingsTemplates();document.getElementById("grid").innerHTML=this.templates.grid;}
mail(){session.refresh();showDialog({title:'Change email:',text:`<center><form action="javascript:" autocomplete="off">
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <div class="popup">
            <span class="popuptext" id="valid">Please insert a valid email address</span></div>
            <input class="mdl-textfield__input" type="email" id="input-1" onkeyup="active.checkEmail()" autocomplete="false">
            <label class="mdl-textfield__label" for="sample1">New email</label>
            </div>
            <div class="mdl-textfield mdl-js-textfield">
            <div class="popup">
            <span class="popuptext" id="match">Emails don´t match</span></div>
            <input class="mdl-textfield__input" type="email" id="input-2" onkeyup="active.checkEmail()">
            <label class="mdl-textfield__label" for="sample1">Repeat</label>
            </div>
            <div class="mdl-textfield mdl-js-textfield">
            <div class="popup">
            <span class="popuptext" id="pw">⮚ 8-20 characters<br>⮚ Contain only and at least one: uppercase, lowercase and number</span>
            </div>
            <input class="mdl-textfield__input" type="password" id="input-3" onkeyup="active.checkEmail()" autocomplete="new-password">
            <label class="mdl-textfield__label" for="input-3">Confirm password</label>
            </div>
            </form></center>`,positive:{title:'<h style="color:green;">Save</h>',id:'save',onClick:function(){active.updateEmail();}},negative:{title:'<h style="color:red;" disabled>Cancel</h>'},onLoaded:function(){tools.hide("save");}});}
password(){session.refresh();showDialog({title:'Change password:',text:`<center>
  <form action="javascript:" autocomplete="off">
    <div class="popup mdl-textfield mdl-js-textfield">
      <div class="popup">
        <span class="popuptext" id="popup1">⮚ 8-20 characters<br>⮚ Contain only and at least one: uppercase, lowercase and number</span>
      </div>
      <input class="mdl-textfield__input" type="password" id="input-1" onkeyup="active.checkPass()" autocomplete="new-password">
      <label id="input-1-text" class="mdl-textfield__label" for="sample1">Current password</label>
    </div>
    <div class="mdl-textfield mdl-js-textfield">
      <div class="popup">
        <span class="popuptext" id="popup2">⮚ 8-20 characters<br>⮚ Contain only and at least one: uppercase, lowercase and number</span>
      </div>
      <div class="popup">
        <span class="popuptext" id="popup2_old">Can´t be the same as your older password</span></div>
      <input class="mdl-textfield__input" type="password" id="input-2" onkeyup="active.checkPass()" autocomplete="new-password">
      <label id="input-2-text" class="mdl-textfield__label" for="sample1">New password</label>
    </div>
    <div class="mdl-textfield mdl-js-textfield">
      <div class="popup">
        <span class="popuptext" id="popup3">Passwords don´t match</span></div>
      <input class="mdl-textfield__input" type="password" id="input-3" onkeyup="active.checkPass()" autocomplete="new-password">
      <label id="input-3-text" class="mdl-textfield__label" for="sample1">Repeat</label>
    </div>
  </form>
</center>`,positive:{title:'<h style="color:green;">Save</h>',id:'save',onClick:function(){active.updatePassword();}},negative:{title:'<h style="color:red;" disabled>Cancel</h>'},onLoaded:function(){tools.hide("save");tools.hide("popup1");}});}
destroy(){session.refresh();showDialog({title:'Please confirm data to delete the account:',text:`<center>
  <form action="javascript:" autocomplete="off">
    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
      <div class="popup">
        <span class="popuptext" id="popup2">Wrong email address</span></div>
      <input class="mdl-textfield__input" type="text" id="input-1" onkeyup="active.checkDestroy()" autocomplete="false">
      <label class="mdl-textfield__label" for="sample1">Email</label>
    </div>
    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
      <div class="popup">
        <span class="popuptext" id="popup3">⮚ 8-20 characters<br>⮚ Contain only and at least one: uppercase, lowercase and number</span>
      </div>
      <input class="mdl-textfield__input" type="password" id="input-2" onkeyup="active.checkDestroy()" autocomplete="new-password">
      <label class="mdl-textfield__label" for="sample1">Password</label>
    </div>
  </form>
</center>`,positive:{title:'<h style="color:red;">Delete</h>',id:'delete',onClick:function(){active.destroyAccount();}},negative:{title:'<h style="color:green;" disabled>Cancel</h>'},onLoaded:function(){tools.hide("delete");}});}
updateEmail(){if(this.checkEmail()){var input_1=document.getElementById("input-1").value;var input_3=document.getElementById("input-3").value;tools.req('/settings/email',function(status,response){if(status===200){alert("E-mail has been changed! Reloading session...");session.logOut();}else{tools.snack("Something went wrong")}}.bind(this),{'new':tools.encodeSTR(input_1),'pw':tools.encodeSTR(input_3)});}}
updatePassword(){if(this.checkPass()){var input_1=document.getElementById("input-1").value;var input_2=document.getElementById("input-2").value;tools.req('/settings/password',function(status,response){if(status===200){alert("Password succesfully changed");}else{tools.snack("Something went wrong")}}.bind(this),{'pw':tools.encodeSTR(input_1),'new':tools.encodeSTR(input_2)});}}
destroyAccount(){if(this.checkDestroy()){var input_2=document.getElementById("input-2").value;tools.req('/settings/destroy',function(status,response){if(status===200){alert("Account succesfully deleted");session.logOut();}else{tools.snack("Something went wrong")}}.bind(this),{'pw':tools.encodeSTR(input_2)});}}
checkEmail(){var email=document.getElementById("input-1").value;var email2=document.getElementById("input-2").value;var pw=document.getElementById("input-3").value;var filter=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var filter2=/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])([a-zA-Z0-9]{8,20})$/;if(email){if(!filter.test(email)){tools.show("valid");tools.hide("match");tools.hide("pw");}else{tools.hide("valid");if(email==email2){if(!filter2.test(pw)){tools.show("pw");tools.hide("match");}else{tools.show("save");tools.hide("match");tools.hide("pw");return true;}}else{tools.show("match");tools.hide("pw");}}}else{tools.hide("match");tools.hide("valid");tools.hide("pw");}
return false;}
checkPass(){var input_1=document.getElementById("input-1");var input_2=document.getElementById("input-2");var input_3=document.getElementById("input-3");var input_1_text=document.getElementById("input-1-text");var input_2_text=document.getElementById("input-2-text");var input_3_text=document.getElementById("input-3-text");var filter=/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])([a-zA-Z0-9]{8,20})$/;if(input_1.value){if(!filter.test(input_1.value)){tools.show("popup1");tools.hide("save");tools.hide("popup3");tools.hide("popup2");tools.hide("popup2_old");}else{tools.hide("popup1");tools.hide("popup2_old");if(input_2.value){if(!filter.test(input_2.value)){tools.show("popup2");tools.hide("save");tools.hide("popup3");}else if(input_2.value==input_1.value){tools.hide("save");tools.hide("popup3");tools.hide("popup2");tools.show("popup2_old");}else{tools.hide("popup2");if(input_2.value==input_3.value){tools.show("save");tools.hide("popup3");return true;}else{tools.show("popup3");tools.hide("save");}}}else{tools.hide("save");tools.hide("popup2");}}}else{tools.hide("save");tools.hide("popup1");}
return false;}
checkDestroy(){var email=document.getElementById("input-1");var pw=document.getElementById("input-2");var filter_email=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var filter_pw=/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])([a-zA-Z0-9]{8,20})$/;if(tools.getCookie('Username')==""){session.logIn("Session expired");}
if(email.value){if(tools.getCookie('Username')!=email.value){tools.show("popup2");tools.hide("popup3");tools.hide("delete");}else if(tools.getCookie('Username')==email.value){tools.hide("popup2");tools.hide("delete");if(pw.value){if(!filter_pw.test(pw.value)){tools.show("popup3");}else{tools.show("delete");tools.hide("popup3");return true;}}}}else{tools.hide("popup2");tools.hide("popup3");tools.hide("delete");}
return false;}}
class settingsTemplates{constructor(){this.grid=`<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
    <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">

        <center>
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty is-upgraded" data-upgraded=",MaterialTextfield">

                <button style="background-color: Transparent; background-repeat:no-repeat; border: none; cursor:pointer; outline:none;" onclick="active.mail();">
                    <i class="material-icons" style="position: center; transform:translateY(70%); font-size:70px;">email</i>
                </button>
            </div>
        </center>
    </div>
</div>

<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
    <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">

        <center>
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty is-upgraded" data-upgraded=",MaterialTextfield">
                <button style="background-color: Transparent; background-repeat:no-repeat; border: none; cursor:pointer; outline:none;" onclick="active.password();">

                    <i class="material-icons" style="position: center; transform:translateY(70%); font-size:70px;">fingerprint</i>
                </button>
            </div>
        </center>
    </div>
</div>

<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">
    <div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">

        <center>
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty is-upgraded" data-upgraded=",MaterialTextfield">
                <button style="background-color: Transparent; background-repeat:no-repeat; border: none; cursor:pointer; outline:none;" onclick="active.destroy();">

                    <i class="material-icons" style="position: center; transform:translateY(70%); font-size:70px;">delete</i>
                </button>
            </div>
        </center>
    </div>
</div>

<div id="demo-toast-example" class="mdl-js-snackbar mdl-snackbar">
    <div class="mdl-snackbar__text"></div>
    <button class="mdl-snackbar__action" type="button"></button>
</div>`;}}